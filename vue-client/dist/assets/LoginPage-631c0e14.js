import{u as b,f as i,r as w,o as l,c as d,a as o,g as y,h as c,v as m,i as h,t as k,j as x,e as p,b as L,w as V}from"./index-91592ea1.js";import{u as N}from"./useApi-49c977da.js";import{u as C}from"./useAuth-174606a9.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";import"./axios-78d57de0.js";const P={class:"login-page"},S={class:"row justify-content-center"},U={class:"col-md-6 col-lg-4"},B={class:"card shadow"},D={class:"card-body p-4"},M={class:"mb-3"},R={class:"mb-3"},j={class:"mb-3 form-check"},q=["disabled"],E={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},I={key:1},J={key:0,class:"alert alert-danger mt-3"},O={class:"text-center mt-3"},T={class:"mb-0"},z={__name:"LoginPage",setup(F){const v=b(),{login:f}=N(),{initializeAuth:u,getCurrentUser:G}=C(),t=i({account:"",password:"",remember:!1}),n=i(!1),a=i(""),_=async()=>{try{n.value=!0,a.value="";const e=await f({name:t.value.account,password:t.value.password});if(console.log("Login response:",e.data),e.data&&e.data.success&&e.data.data)u(e.data.data.token,e.data.data.user);else if(e.data&&e.data.token)u(e.data.token,e.data.user);else throw new Error("Invalid response format: "+JSON.stringify(e.data));v.push("/rooms")}catch(e){console.error("Login error:",e),e.response&&e.response.data?a.value=e.response.data.message||"Login failed: "+JSON.stringify(e.response.data):e.message?a.value=e.message:a.value="Login failed: "+e}finally{n.value=!1}};return(e,s)=>{const g=w("router-link");return l(),d("div",P,[o("div",S,[o("div",U,[o("div",B,[o("div",D,[s[8]||(s[8]=o("h2",{class:"card-title text-center mb-4"},"Login",-1)),o("form",{onSubmit:y(_,["prevent"])},[o("div",M,[s[3]||(s[3]=o("label",{for:"account",class:"form-label"},"Account",-1)),c(o("input",{type:"text",class:"form-control",id:"account","onUpdate:modelValue":s[0]||(s[0]=r=>t.value.account=r),required:""},null,512),[[m,t.value.account]])]),o("div",R,[s[4]||(s[4]=o("label",{for:"password",class:"form-label"},"Password",-1)),c(o("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":s[1]||(s[1]=r=>t.value.password=r),required:""},null,512),[[m,t.value.password]])]),o("div",j,[c(o("input",{type:"checkbox",class:"form-check-input",id:"remember","onUpdate:modelValue":s[2]||(s[2]=r=>t.value.remember=r)},null,512),[[h,t.value.remember]]),s[5]||(s[5]=o("label",{class:"form-check-label",for:"remember"},"Remember me",-1))]),o("button",{type:"submit",class:"btn btn-primary w-100",disabled:n.value},[n.value?(l(),d("span",E)):(l(),d("span",I,"Login"))],8,q),a.value?(l(),d("div",J,k(a.value),1)):x("",!0)],32),o("div",O,[o("p",T,[s[7]||(s[7]=p("Don't have an account? ",-1)),L(g,{to:"/register"},{default:V(()=>[...s[6]||(s[6]=[p("Register",-1)])]),_:1})])])])])])])])}}},Y=A(z,[["__scopeId","data-v-de642995"]]);export{Y as default};
//# sourceMappingURL=LoginPage-631c0e14.js.map
