{"version":3,"file":"LoginPage-631c0e14.js","sources":["../../src/pages/LoginPage.vue"],"sourcesContent":["<template>\n  <div class=\"login-page\">\n    <div class=\"row justify-content-center\">\n      <div class=\"col-md-6 col-lg-4\">\n        <div class=\"card shadow\">\n          <div class=\"card-body p-4\">\n            <h2 class=\"card-title text-center mb-4\">Login</h2>\n            \n            <form @submit.prevent=\"handleLogin\">\n              <div class=\"mb-3\">\n                <label for=\"account\" class=\"form-label\">Account</label>\n                <input \n                  type=\"text\" \n                  class=\"form-control\" \n                  id=\"account\" \n                  v-model=\"form.account\" \n                  required\n                >\n              </div>\n              \n              <div class=\"mb-3\">\n                <label for=\"password\" class=\"form-label\">Password</label>\n                <input \n                  type=\"password\" \n                  class=\"form-control\" \n                  id=\"password\" \n                  v-model=\"form.password\" \n                  required\n                >\n              </div>\n              \n              <div class=\"mb-3 form-check\">\n                <input type=\"checkbox\" class=\"form-check-input\" id=\"remember\" v-model=\"form.remember\">\n                <label class=\"form-check-label\" for=\"remember\">Remember me</label>\n              </div>\n              \n              <button type=\"submit\" class=\"btn btn-primary w-100\" :disabled=\"loading\">\n                <span v-if=\"loading\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\n                <span v-else>Login</span>\n              </button>\n              \n              <div v-if=\"error\" class=\"alert alert-danger mt-3\">\n                {{ error }}\n              </div>\n            </form>\n            \n            <div class=\"text-center mt-3\">\n              <p class=\"mb-0\">Don't have an account? <router-link to=\"/register\">Register</router-link></p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useApi } from '@/composables/useApi'\nimport { useAuth } from '@/composables/useAuth'\n\nconst router = useRouter()\nconst { login } = useApi()\nconst { initializeAuth, getCurrentUser } = useAuth()\n\nconst form = ref({\n  account: '',\n  password: '',\n  remember: false\n})\n\nconst loading = ref(false)\nconst error = ref('')\n\nconst handleLogin = async () => {\n  try {\n    loading.value = true\n    error.value = ''\n    \n    const response = await login({\n      name: form.value.account,\n      password: form.value.password\n    })\n    \n    console.log('Login response:', response.data) // Debug logging\n    \n    // Handle the API response format correctly\n    if (response.data && response.data.success && response.data.data) {\n      // New API response format - use pure Pinia approach\n      initializeAuth(response.data.data.token, response.data.data.user)\n    } else if (response.data && response.data.token) {\n      // Legacy response format - use pure Pinia approach\n      initializeAuth(response.data.token, response.data.user)\n    } else {\n      throw new Error('Invalid response format: ' + JSON.stringify(response.data))\n    }\n    \n    // Redirect to rooms\n    router.push('/rooms')\n    \n  } catch (err) {\n    console.error('Login error:', err)\n    if (err.response && err.response.data) {\n      error.value = err.response.data.message || 'Login failed: ' + JSON.stringify(err.response.data)\n    } else if (err.message) {\n      error.value = err.message\n    } else {\n      error.value = 'Login failed: ' + err\n    }\n  } finally {\n    loading.value = false\n  }\n}\n</script>\n\n<style scoped>\n.login-page {\n  min-height: 70vh;\n  display: flex;\n  align-items: center;\n}\n\n.card {\n  border: none;\n}\n</style>"],"names":["router","useRouter","login","useApi","initializeAuth","getCurrentUser","useAuth","form","ref","loading","error","handleLogin","response","err","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_cache","_hoisted_6","$event","_vModelText","_hoisted_7","_hoisted_8","_vModelCheckbox","_hoisted_10","_hoisted_12","_toDisplayString","_hoisted_13","_hoisted_14","_createVNode","_component_router_link"],"mappings":"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"}