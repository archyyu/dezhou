import{u as E,f as i,k as I,l as $,M as A,o as t,c as l,a as e,F as h,m as R,j as _,t as r,h as w,n as D,v as S,p as U}from"./index-02cc848c.js";import{u as z}from"./useApi-0fdb8b38.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import"./axios-78d57de0.js";const J={class:"rooms-page container mt-4"},q={class:"card mb-4"},H={class:"card-body"},K={class:"d-flex justify-content-between align-items-center mb-3"},O=["disabled"],Q={class:"room-types mb-3"},W=["onClick"],X={key:0,class:"text-center"},Y={class:"card"},Z={class:"card-body"},ee={key:0,class:"text-center my-4"},se={key:1,class:"alert alert-danger"},ae={key:2,class:"alert alert-info"},oe={class:"room-list"},te={class:"card-body"},le={class:"d-flex justify-content-between align-items-center"},ne={class:"card-title mb-1"},de={class:"card-text mb-1"},ie={class:"badge bg-secondary me-2"},re={class:"text-muted"},ce=["onClick","disabled"],me={class:"modal fade",id:"createRoomModal",tabindex:"-1","aria-labelledby":"createRoomModalLabel","aria-hidden":"true"},ue={class:"modal-dialog"},ve={class:"modal-content"},be={class:"modal-body"},ye={class:"mb-3"},pe=["value"],_e={class:"mb-3"},fe={class:"modal-footer"},ge=["disabled"],he={__name:"RoomsPage",setup(Re){const{getRoomTypeList:C,getRoomsByType:M,createRoom:N,joinRoom:F}=z(),P=E(),c=i([]),m=i([]),v=i(null),f=i(!1),b=i(!1),u=i(!1),n=i(""),y=i(null),p=i("");let g=null;const T=I(()=>{const o={};return console.log(m),m.value.forEach(s=>{o[s.roomTypeId]=(o[s.roomTypeId]||0)+1}),o});$(async()=>{await j(),g=new A(document.getElementById("createRoomModal"))});const j=async()=>{var o,s;try{f.value=!0,n.value="";const a=await C();c.value=a.data.data,c.value.length>0&&x(c.value[0].id)}catch(a){n.value="Failed to load room types: "+(((s=(o=a.response)==null?void 0:o.data)==null?void 0:s.message)||a.message)}finally{f.value=!1}},x=async o=>{v.value=o,await k(o)},k=async o=>{var s,a;try{b.value=!0,n.value="",m.value=[];const d=await M(o);m.value=d.data.data,console.log(m)}catch(d){n.value="Failed to load rooms: "+(((a=(s=d.response)==null?void 0:s.data)==null?void 0:a.message)||d.message)}finally{b.value=!1}},L=()=>{c.value.length>0&&(y.value=c.value[0].id,p.value=`Room ${Math.floor(Math.random()*1e3)}`,g.show())},B=async()=>{var o,s;try{u.value=!0,n.value="";const a=await N(y.value,p.value);await k(v.value),g.hide()}catch(a){n.value="Failed to create room: "+(((s=(o=a.response)==null?void 0:o.data)==null?void 0:s.message)||a.message)}finally{u.value=!1}},V=async o=>{var s,a;try{u.value=!0,n.value="";const d=await F(o);P.push({name:"game",params:{roomId:o}})}catch(d){n.value="Failed to join room: "+(((a=(s=d.response)==null?void 0:s.data)==null?void 0:a.message)||d.message)}finally{u.value=!1}};return(o,s)=>(t(),l("div",J,[s[10]||(s[10]=e("h2",{class:"mb-4"},"Game Rooms",-1)),e("div",q,[e("div",H,[e("div",K,[s[2]||(s[2]=e("h5",{class:"card-title mb-0"},"Room Types",-1)),e("button",{onClick:L,class:"btn btn-success",disabled:u.value}," Create Room ",8,O)]),e("div",Q,[(t(!0),l(h,null,R(c.value,a=>(t(),l("button",{key:a.id,onClick:d=>x(a.id),class:U(["btn me-2 mb-2",{"btn-primary":v.value===a.id,"btn-outline-primary":v.value!==a.id}])},r(a.name)+" ("+r(T.value[a.id]||0)+") ",11,W))),128))]),f.value?(t(),l("div",X,[...s[3]||(s[3]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)])])):_("",!0)])]),e("div",Y,[e("div",Z,[s[5]||(s[5]=e("h5",{class:"card-title"},"Available Rooms",-1)),b.value?(t(),l("div",ee,[...s[4]||(s[4]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)])])):_("",!0),n.value?(t(),l("div",se,r(n.value),1)):_("",!0),!b.value&&m.value.length===0?(t(),l("div",ae," No rooms available for this type. Create one! ")):_("",!0),e("div",oe,[(t(!0),l(h,null,R(m.value,a=>(t(),l("div",{key:a.roomid,class:"card mb-3 room-card"},[e("div",te,[e("div",le,[e("div",null,[e("h5",ne,r(a.name),1),e("p",de,[e("span",ie,r(a.roomTypeName),1),e("span",re,"Players: "+r(1)+" / "+r(a.maxPlayers),1)])]),e("div",null,[e("button",{onClick:d=>V(a.roomid),class:"btn btn-primary btn-sm",disabled:u.value||1>=a.maxPlayers},r(1>=a.maxPlayers?"Full":"Join"),9,ce)])])])]))),128))])])]),e("div",me,[e("div",ue,[e("div",ve,[s[9]||(s[9]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"createRoomModalLabel"},"Create New Room"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",be,[e("div",ye,[s[6]||(s[6]=e("label",{class:"form-label"},"Room Type",-1)),w(e("select",{"onUpdate:modelValue":s[0]||(s[0]=a=>y.value=a),class:"form-select"},[(t(!0),l(h,null,R(c.value,a=>(t(),l("option",{key:a.id,value:a.id},r(a.name),9,pe))),128))],512),[[D,y.value]])]),e("div",_e,[s[7]||(s[7]=e("label",{class:"form-label"},"Room Name",-1)),w(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>p.value=a),type:"text",class:"form-control",placeholder:"My Poker Room"},null,512),[[S,p.value]])])]),e("div",fe,[s[8]||(s[8]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:B,disabled:u.value}," Create Room ",8,ge)])])])])]))}},Me=G(he,[["__scopeId","data-v-3867bb7a"]]);export{Me as default};
//# sourceMappingURL=RoomsPage-3b517491.js.map
