import{a as i}from"./axios-78d57de0.js";import{q as a}from"./index-91592ea1.js";const n=a("auth",{state:()=>({token:null,user:null,loading:!1,error:null,isAuthenticated:!1}),actions:{setToken(t){this.token=t,this.isAuthenticated=!!t},setUser(t){this.user=t,this.isAuthenticated=!!t},setLoading(t){this.loading=t},setError(t){this.error=t},clearAuth(){this.token=null,this.user=null,this.isAuthenticated=!1,this.error=null},initializeFromSession(t,s){this.setToken(t),this.setUser(s)},updateUserProfile(t){this.user&&(this.user={...this.user,...t})}},getters:{currentUser:t=>t.user,authToken:t=>t.token,isAuth:t=>t.isAuthenticated,userId:t=>{var s,e;return((s=t.user)==null?void 0:s.uid)||((e=t.user)==null?void 0:e.id)||null},username:t=>{var s,e;return((s=t.user)==null?void 0:s.name)||((e=t.user)==null?void 0:e.username)||"Guest"}}});function p(){const t="http://localhost:8080";console.log("API Base URL:",t);const s=i.create({baseURL:t,headers:{"Content-Type":"application/json"}});return s.interceptors.request.use(e=>{const r=n().token;return r&&(e.headers.Authorization=`Bearer ${r}`),e}),s.interceptors.response.use(e=>e,e=>{var o;return((o=e.response)==null?void 0:o.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)}),{login:e=>s.post("/api/v1/user/login",null,{params:e}),register:e=>s.post("/api/v1/user/register",null,{params:e}),getRoomTypeList:()=>s.get("/api/v1/room/roomTypeList"),getRoomsByType:e=>s.get(`/api/v1/room/${e}/list`),getAllRooms:()=>s.get("/api/v1/room/list"),joinRoom:e=>s.post(`/api/v1/room/${e}/join`),leaveRoom:e=>s.post(`/api/v1/room/${e}/leave`),createRoom:(e,o)=>s.post(`/api/v1/room/create/${e}/${o}`),gameAction:(e,o,r)=>s.post(`/api/v1/game/${e}/actions`,r,{params:{cmd:o}}),getUserProfile:e=>s.get(`/api/v1/user/info/${e}`),updateProfile:e=>s.put("/api/v1/user/profile",null,{params:{...e}}),getMessages:()=>s.get("/api/v1/user/messages"),sendMessage:e=>s.post("/api/v1/user/messages",e),get:e=>s.get(e),post:(e,o)=>s.post(e,o),put:(e,o)=>s.put(e,o),delete:e=>s.delete(e)}}export{n as a,p as u};
//# sourceMappingURL=useApi-49c977da.js.map
