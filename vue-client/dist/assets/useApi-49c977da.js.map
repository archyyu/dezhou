{"version":3,"file":"useApi-49c977da.js","sources":["../../src/stores/authStore.js","../../src/composables/useApi.js"],"sourcesContent":["import { defineStore } from 'pinia'\n\n/**\n * Auth store for managing authentication state\n * Pure Pinia implementation - no localStorage dependency for user data\n */\nexport const useAuthStore = defineStore('auth', {\n  state: () => ({\n    // Authentication state\n    token: null,\n    \n    // User information\n    user: null,\n    \n    // Loading and error states\n    loading: false,\n    error: null,\n    \n    // Authentication status\n    isAuthenticated: false\n  }),\n  \n  actions: {\n    /**\n     * Set authentication token\n     */\n    setToken(token) {\n      this.token = token\n      this.isAuthenticated = !!token\n    },\n    \n    /**\n     * Set user information\n     */\n    setUser(user) {\n      this.user = user\n      this.isAuthenticated = !!user\n    },\n    \n    /**\n     * Set loading state\n     */\n    setLoading(loading) {\n      this.loading = loading\n    },\n    \n    /**\n     * Set error state\n     */\n    setError(error) {\n      this.error = error\n    },\n    \n    /**\n     * Clear authentication data\n     */\n    clearAuth() {\n      this.token = null\n      this.user = null\n      this.isAuthenticated = false\n      this.error = null\n    },\n    \n    /**\n     * Initialize auth store from existing session\n     */\n    initializeFromSession(token, user) {\n      this.setToken(token)\n      this.setUser(user)\n    },\n    \n    /**\n     * Update user profile\n     */\n    updateUserProfile(profileData) {\n      if (this.user) {\n        this.user = { ...this.user, ...profileData }\n      }\n    }\n  },\n  \n  getters: {\n    /**\n     * Get current user\n     */\n    currentUser: (state) => state.user,\n    \n    /**\n     * Get authentication token\n     */\n    authToken: (state) => state.token,\n    \n    /**\n     * Check if user is authenticated\n     */\n    isAuth: (state) => state.isAuthenticated,\n    \n    /**\n     * Get user ID\n     */\n    userId: (state) => state.user?.uid || state.user?.id || null,\n    \n    /**\n     * Get user name\n     */\n    username: (state) => state.user?.name || state.user?.username || 'Guest'\n  }\n})","import axios from 'axios'\nimport { useAuthStore } from '@/stores/authStore'\n\n/**\n * API composable for making HTTP requests to the backend\n */\nexport function useApi() {\n  // Create axios instance\n  const apiBaseURL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8080'\n  console.log('API Base URL:', apiBaseURL) // Debug logging\n  \n  const api = axios.create({\n    baseURL: apiBaseURL,\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  })\n\n  // Add request interceptor for authentication using Pinia store\n  api.interceptors.request.use(config => {\n    const authStore = useAuthStore()\n    const token = authStore.token\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`\n    }\n    return config\n  })\n\n  // Add response interceptor for error handling\n  api.interceptors.response.use(\n    response => response,\n    error => {\n      if (error.response?.status === 401) {\n        // Handle unauthorized access\n        localStorage.removeItem('token')\n        localStorage.removeItem('user')\n        window.location.href = '/login'\n      }\n      return Promise.reject(error)\n    }\n  )\n\n  return {\n    // Authentication\n    login: (credentials) => api.post('/api/v1/user/login', null, { params: credentials }),\n    register: (userData) => api.post('/api/v1/user/register', null, { params: userData }),\n    \n    // Room management\n    getRoomTypeList: () => api.get('/api/v1/room/roomTypeList'),\n    getRoomsByType: (roomTypeId) => api.get(`/api/v1/room/${roomTypeId}/list`),\n    getAllRooms: () => api.get('/api/v1/room/list'),\n    joinRoom: (roomId) => api.post(`/api/v1/room/${roomId}/join`),\n    leaveRoom: (roomId) => api.post(`/api/v1/room/${roomId}/leave`),\n    createRoom: (roomTypeId, roomName) => api.post(`/api/v1/room/create/${roomTypeId}/${roomName}`),\n    \n    // Game actions\n    gameAction: (roomId, cmd, additionalParams) => api.post(`/api/v1/game/${roomId}/actions`, additionalParams, { \n      params: { cmd }\n    }),\n    \n    // User\n    getUserProfile: (uid) => api.get(`/api/v1/user/info/${uid}`),\n    updateProfile: (profileData) => api.put('/api/v1/user/profile', null, { \n      params: { ...profileData }\n    }),\n    \n    // Message handling\n    getMessages: () => api.get('/api/v1/user/messages'),\n    sendMessage: (message) => api.post('/api/v1/user/messages', message),\n    \n    // Generic methods\n    get: (url) => api.get(url),\n    post: (url, data) => api.post(url, data),\n    put: (url, data) => api.put(url, data),\n    delete: (url) => api.delete(url)\n  }\n}"],"names":["useAuthStore","defineStore","token","user","loading","error","profileData","state","_a","_b","useApi","apiBaseURL","api","axios","config","response","credentials","userData","roomTypeId","roomId","roomName","cmd","additionalParams","uid","message","url","data"],"mappings":"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"}