{"version":3,"file":"useAuth-174606a9.js","sources":["../../src/composables/useAuth.js"],"sourcesContent":["import { useAuthStore } from '@/stores/authStore'\nimport { useApi } from './useApi'\n\n/**\n * Authentication composable for managing user session and profile\n * Pure Pinia implementation - uses authStore for all state management\n */\nexport function useAuth() {\n  const authStore = useAuthStore()\n  const { getUserProfile } = useApi()\n\n  /**\n   * Get current user from Pinia store, fetch from API if needed\n   */\n  const getCurrentUser = async (forceRefresh = false) => {\n    // If we have a user in store and don't need to refresh, return it\n    if (!forceRefresh && authStore.user) {\n      return authStore.user\n    }\n\n    // If we have a token but no user, try to fetch user profile\n    if (authStore.token) {\n      try {\n        authStore.setLoading(true)\n        authStore.setError(null)\n        \n        const response = await getUserProfile()\n        if (response.data) {\n          authStore.setUser(response.data)\n          return response.data\n        }\n      } catch (err) {\n        authStore.setError(err.response?.data?.message || err.message || 'Failed to fetch user')\n        console.error('Failed to get current user:', err)\n        return null\n      } finally {\n        authStore.setLoading(false)\n      }\n    }\n    \n    return authStore.user\n  }\n\n  /**\n   * Initialize authentication from existing session (token + user)\n   */\n  const initializeAuth = (token, user) => {\n    authStore.initializeFromSession(token, user)\n  }\n\n  /**\n   * Check if user is authenticated\n   */\n  const isAuthenticated = () => {\n    return authStore.isAuthenticated\n  }\n\n  /**\n   * Clear authentication data\n   */\n  const clearAuth = () => {\n    authStore.clearAuth()\n  }\n\n  /**\n   * Get authentication token\n   */\n  const getToken = () => {\n    return authStore.token\n  }\n\n  /**\n   * Update user profile\n   */\n  const updateProfile = (profileData) => {\n    authStore.updateUserProfile(profileData)\n  }\n\n  return {\n    // Direct access to auth store state\n    user: authStore.currentUser,\n    token: authStore.authToken,\n    loading: authStore.loading,\n    error: authStore.error,\n    isAuthenticated: authStore.isAuth,\n    \n    // Auth actions\n    getCurrentUser,\n    initializeAuth,\n    clearAuth,\n    getToken,\n    updateProfile,\n    \n    // Direct store access for advanced use cases\n    authStore\n  }\n}"],"names":["useAuth","authStore","useAuthStore","getUserProfile","useApi","getCurrentUser","forceRefresh","response","err","_b","_a","initializeAuth","token","user","clearAuth","getToken","updateProfile","profileData"],"mappings":"gDAOO,SAASA,GAAU,CACxB,MAAMC,EAAYC,EAAc,EAC1B,CAAE,eAAAC,CAAgB,EAAGC,EAAQ,EAK7BC,EAAiB,MAAOC,EAAe,KAAU,SAErD,GAAI,CAACA,GAAgBL,EAAU,KAC7B,OAAOA,EAAU,KAInB,GAAIA,EAAU,MACZ,GAAI,CACFA,EAAU,WAAW,EAAI,EACzBA,EAAU,SAAS,IAAI,EAEvB,MAAMM,EAAW,MAAMJ,EAAgB,EACvC,GAAII,EAAS,KACX,OAAAN,EAAU,QAAQM,EAAS,IAAI,EACxBA,EAAS,IAEnB,OAAQC,EAAK,CACZ,OAAAP,EAAU,WAASQ,GAAAC,EAAAF,EAAI,WAAJ,YAAAE,EAAc,OAAd,YAAAD,EAAoB,UAAWD,EAAI,SAAW,sBAAsB,EACvF,QAAQ,MAAM,8BAA+BA,CAAG,EACzC,IACf,QAAgB,CACRP,EAAU,WAAW,EAAK,CAC3B,CAGH,OAAOA,EAAU,IAClB,EAKKU,EAAiB,CAACC,EAAOC,IAAS,CACtCZ,EAAU,sBAAsBW,EAAOC,CAAI,CAC5C,EAYKC,EAAY,IAAM,CACtBb,EAAU,UAAW,CACtB,EAKKc,EAAW,IACRd,EAAU,MAMbe,EAAiBC,GAAgB,CACrChB,EAAU,kBAAkBgB,CAAW,CACxC,EAED,MAAO,CAEL,KAAMhB,EAAU,YAChB,MAAOA,EAAU,UACjB,QAASA,EAAU,QACnB,MAAOA,EAAU,MACjB,gBAAiBA,EAAU,OAG3B,eAAAI,EACA,eAAAM,EACA,UAAAG,EACA,SAAAC,EACA,cAAAC,EAGA,UAAAf,CACD,CACH"}